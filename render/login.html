<!doctype html>
<html>
<head>

    <meta charset="utf-8">
    <title>Login</title>
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
    <link href="../assets/design/core.css" rel="stylesheet">
    <link href="../assets/design/login.css" rel="stylesheet">

    <script>
        const remote = require("electron").remote;
        const moment = require("moment");
        window.$ = window.jQuery = require("jquery");

        $(() => {
            const users = [
                {
                    name: "Kurisu Brooks",
                    avatar: "kurisu",
                    password: "cheese"
                },
                {
                    name: "Katie Sekai",
                    avatar: "katie",
                    password: "tomato"
                },
                {
                    name: "Sammy Sekai",
                    avatar: "sammy",
                    password: "pumpkin"
                }
            ];

            const padding = users.length - 1;
            let selectedUserIndex = null;
            let selectedUser = null;

            for (let index = 0; index < users.length; index++) {
                const head = $(`<div class="head" data-user=${index} style="background-image: url(../assets/avatars/${users[index].avatar}.png);"></div>`);

                if (index === 0) selectUser(head);

                $(".heads").append(head);
            }

            $("body").fadeIn(500);

            setInterval(() => {
                let time = moment().format("H:mm");
                if ($(".time").text() !== time) $(".time").text(time);
            }, 150);

            $(".head").not(".ghost").click((e) => {
                selectUser(e.target);
            });

            function selectUser(head) {
                head = $(head);
                const index = head.data("user");

                if(selectedUserIndex === index) return;

                $(".head").removeClass("active");

                head.addClass("active");
                $(".login .form .title").text(users[index].name);
                selectedUserIndex = index;
                selectedUser = users[selectedUserIndex]

                $(".ghost").remove();

                const rightElements = users.length - selectedUserIndex - 1;

                addGhosts(Math.abs(selectedUserIndex - rightElements), selectedUserIndex > rightElements);
            }

            function addGhosts(amount, append) {
                const type = append ? "append" : "prepend";
                for (let ghosts = 0; ghosts < amount; ghosts++) {
                    $(".heads")[type]($(`<div class="head ghost"></div>`));
                }
            }

            /*$("login").submit((e) => {
                let success = true;
                let user = e.target[0].value.replace("user:", "");
                let pass = e.target[1].value;

                if (success) {
                    setTimeout(() => $("login").fadeOut(250), 1000);
                    setTimeout(() => $("main").fadeOut(250), 1500);
                    setTimeout(() => remote.getCurrentWindow().loadURL(`file://${__dirname}/desktop.html`), 1600);
                }
            });*/
        });
    </script>

</head>
<body>

    <div class="container">
        <div class="top">
            <div class="time"></div>
            <div class="buttons">
                <!--<button class="power"></button>-->
            </div>
        </div>

        <div class="login">
            <div class="heads"></div>
            <div class="form">
                <div class="title"></div>
                <div class="password">
                    <input id="password" type="password" placeholder="Password" required>
                </div>
            </div>
        </div>

        <div class="bottom">
            <div class="info">
                <img src="../assets/icons/lock.svg">
            </div>
        </div>
    </div>

</body>
</html>
